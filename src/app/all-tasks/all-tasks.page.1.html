<ion-header>
  <ion-toolbar>
    <ion-buttons slot="start">
      <ion-menu-button menu="start"></ion-menu-button>
    </ion-buttons>
    <ion-title>Tasks</ion-title>
    <ion-buttons slot="end">
      <ion-button color="dark" round end-item slot="icon">
        <ion-badge color="danger" class="notifications" slot="start">11</ion-badge>
        <ion-icon name="notifications-outline"></ion-icon>
      </ion-button>
      <ion-button color="secondary" solid round end-item icon-end class="toolbar-round">Add Task
        <ion-icon slot="start" name="add-circle"></ion-icon>
      </ion-button>
      <ion-menu-button menu="end"></ion-menu-button>
    </ion-buttons>
  </ion-toolbar>
</ion-header>
<ion-content>
  <ion-split-pane when="(min-width: 1024px)" (ionChange)="toggleHack($event)">
    <!--  our side menu  -->
    <ion-menu menu-id="start" [ngClass]="{'collapse-pane': !panesToggle.start && panesToggle.toggleHack}">

      <ion-toolbar>
        <ion-buttons slot="start" [hidden]="!panesToggle.start && panesToggle.toggleHack">
          <ion-button color="secondary" solid round end-item icon-end class="toolbar-round">Add Filter
            <ion-icon slot="start" name="add-circle"></ion-icon>
          </ion-button>
        </ion-buttons>
        <ion-buttons slot="end">
          <ion-button color="dark" clear class="toolbar-round" [hidden]="!panesToggle.toggleHack" (click)="toggleMenu('start')">
            <ion-icon [hidden]="!panesToggle.start" name="arrow-dropleft"></ion-icon>
            <ion-icon [hidden]="panesToggle.start" name="arrow-dropright"></ion-icon>
          </ion-button>
        </ion-buttons>
      </ion-toolbar>
      <ion-content>
        <ion-list lines="full">
          <ion-item *ngFor="let filter of filters" (click)="listFilter(filter.id)">
            <!-- <ion-avatar slot="start">
                    <img [src]="task.pic">
                  </ion-avatar>
                -->
            <ion-label text-wrap>
              <ion-text>
                <h3 appOnCreate (OnCreateDirective)="getFilterCount(filter)">
                  {{filter.name}}
                  <ion-badge color="secondary" slot="end">{{filter.count}}</ion-badge>
                </h3>
              </ion-text>

            </ion-label>

            <ion-buttons slot="end" class="hide-md hide-sm">
              <ion-button clear color="dark" slot="icon-only">
                <ion-icon name="md-create"></ion-icon>
              </ion-button>
            </ion-buttons>

          </ion-item>
        </ion-list>
      </ion-content>
    </ion-menu>

    <!-- the main content -->
    <ion-grid no-padding main>
      <ion-row nowrap class="forecast_container">
        <ion-col size-xs="12" size-sm="12" no-padding [ngClass]="{'full-pane': panesToggle.middle && panesToggle.end === false,'collapse-pane': !panesToggle.middle, 'tasks-pane' : true}">
          <ion-toolbar>
            <ion-searchbar no-padding [(ngModel)]="filter.textSearch" [ngStyle]="{'height':'48px' }" mode="ios" slot="start" animated
              [showCancelButton]="false" (ionChange)="search($event)" (ionCancel)="search($event)">
            </ion-searchbar>
            <ion-buttons slot="end">
              <ion-button color="dark" clear class="toolbar-round" (click)="toggleMenu('middle')">
                <ion-icon [hidden]="!panesToggle.middle" name="arrow-dropleft"></ion-icon>
                <ion-icon [hidden]="panesToggle.middle" name="arrow-dropright"></ion-icon>
              </ion-button>
            </ion-buttons>
          </ion-toolbar>
          <!--<tasks [data]="tasks" [attribute]="'assignee'" [value]="'ahmad'" [cond]="'contains'" [title]="'Assigned to Ahmad'"></tasks>-->
          <ion-content [ngClass]="{'inner-content':true }">
            <ion-scroll [ngClass]="{'inner-scroll':true }">
              <ion-grid padding>
                <ion-row>

                  <ion-col size="10" size-lg="11" class="filter">
                    <ion-select interface="popover" [interfaceOptions]="{event:popoverClick}" class="pull-right" placeholder="Sort By" [(ngModel)]="filter.sortingProp"
                      (ionChange)="sortArray(filter.sortingDirection)">
                      <ion-select-option [value]="{name:'name',type:'string'}">Name</ion-select-option>
                      <ion-select-option [value]="{name:'due',type:'datetime'}">Due Date</ion-select-option>
                      <ion-select-option [value]="{name:'created',type:'datetime'}">Created Date</ion-select-option>
                      <ion-select-option [value]="{name:'priority',type:'number'}">Priority</ion-select-option>
                      <ion-select-option [value]="{name:'assignee',type:'string'}">Assignee</ion-select-option>
                    </ion-select>
                  </ion-col>
                  <ion-col size="2" size-lg="1">
                    <ion-buttons>
                      <ion-button color="dark" clear round end right icon-only (click)="setSortingDirection()">
                        <ion-icon [name]="filter.sortingDirection == 1 ? 'md-arrow-down' : 'md-arrow-up'"></ion-icon>

                      </ion-button>
                    </ion-buttons>
                  </ion-col>
                </ion-row>
              </ion-grid>

              <ion-list lines="full">
                <ion-item *ngFor="let task of tsks" (click)="chooseTask(task)">
                  <!-- <ion-avatar slot="start">
                        <img [src]="task.pic">
                      </ion-avatar>
                    -->
                  <ion-label text-wrap>
                    <ion-text>
                      <h3>
                        {{task.name}}
                        <ion-badge [color]="getPriority(task.priority)" slot="end" [innerHTML]="getStatus(task.priority)"></ion-badge>
                      </h3>
                    </ion-text>
                    <div class="more-details">
                      <p>{{task.description}}</p>
                    </div>
                    <ion-row class="actions-toolbar">
                      <ion-col center text-center class="extra-pad">
                        <ion-note>
                          Created at {{task.due | date}}
                        </ion-note>
                      </ion-col>
                      <ion-col center text-center class="extra-pad">
                        <ion-note>
                          Due by {{task.due | date}}
                        </ion-note>
                      </ion-col>
                    </ion-row>
                  </ion-label>

                  <ion-buttons slot="end" class="hide-md hide-sm">
                    <ion-button clear color="dark" slot="icon-only" (click)="presentPopover($event)">
                      <ion-icon name="md-more"></ion-icon>
                    </ion-button>
                  </ion-buttons>

                </ion-item>
              </ion-list>
              <ion-infinite-scroll threshold="100px" (ionInfinite)="loadData($event)">
                <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Loading more data...">
                </ion-infinite-scroll-content>
              </ion-infinite-scroll>
            </ion-scroll>
          </ion-content>
        </ion-col>
        <ion-col size-xs="12" size-sm="12" no-padding [ngClass]="{'full-pane': panesToggle.middle && panesToggle.end === false,'collapse-pane': !panesToggle.middle, 'tasks-pane' : true}">
          <ion-toolbar>
            <ion-searchbar no-padding [(ngModel)]="filter.textSearch" [ngStyle]="{'height':'48px' }" mode="ios" slot="start" animated
              [showCancelButton]="false" (ionChange)="search($event)" (ionCancel)="search($event)">
            </ion-searchbar>
            <ion-buttons slot="end">
              <ion-button color="dark" clear class="toolbar-round" (click)="toggleMenu('middle')">
                <ion-icon [hidden]="!panesToggle.middle" name="arrow-dropleft"></ion-icon>
                <ion-icon [hidden]="panesToggle.middle" name="arrow-dropright"></ion-icon>
              </ion-button>
            </ion-buttons>
          </ion-toolbar>
          <!--<tasks [data]="tasks" [attribute]="'assignee'" [value]="'ahmad'" [cond]="'contains'" [title]="'Assigned to Ahmad'"></tasks>-->
          <ion-content [ngClass]="{'inner-content':true }">
            <ion-scroll [ngClass]="{'inner-scroll':true }">
              <ion-grid padding>
                <ion-row>

                  <ion-col size="10" size-lg="11" class="filter">
                    <ion-select interface="popover" [interfaceOptions]="{event:popoverClick}" class="pull-right" placeholder="Sort By" [(ngModel)]="filter.sortingProp"
                      (ionChange)="sortArray(filter.sortingDirection)">
                      <ion-select-option [value]="{name:'name',type:'string'}">Name</ion-select-option>
                      <ion-select-option [value]="{name:'due',type:'datetime'}">Due Date</ion-select-option>
                      <ion-select-option [value]="{name:'created',type:'datetime'}">Created Date</ion-select-option>
                      <ion-select-option [value]="{name:'priority',type:'number'}">Priority</ion-select-option>
                      <ion-select-option [value]="{name:'assignee',type:'string'}">Assignee</ion-select-option>
                    </ion-select>
                  </ion-col>
                  <ion-col size="2" size-lg="1">
                    <ion-buttons>
                      <ion-button color="dark" clear round end right icon-only (click)="setSortingDirection()">
                        <ion-icon [name]="filter.sortingDirection == 1 ? 'md-arrow-down' : 'md-arrow-up'"></ion-icon>

                      </ion-button>
                    </ion-buttons>
                  </ion-col>
                </ion-row>
              </ion-grid>

              <ion-list lines="full">
                <ion-item *ngFor="let task of tsks" (click)="chooseTask(task)">
                  <!-- <ion-avatar slot="start">
                          <img [src]="task.pic">
                        </ion-avatar>
                      -->
                  <ion-label text-wrap>
                    <ion-text>
                      <h3>
                        {{task.name}}
                        <ion-badge [color]="getPriority(task.priority)" slot="end" [innerHTML]="getStatus(task.priority)"></ion-badge>
                      </h3>
                    </ion-text>
                    <div class="more-details">
                      <p>{{task.description}}</p>
                    </div>
                    <ion-row class="actions-toolbar">
                      <ion-col center text-center class="extra-pad">
                        <ion-note>
                          Created at {{task.due | date}}
                        </ion-note>
                      </ion-col>
                      <ion-col center text-center class="extra-pad">
                        <ion-note>
                          Due by {{task.due | date}}
                        </ion-note>
                      </ion-col>
                    </ion-row>
                  </ion-label>

                  <ion-buttons slot="end" class="hide-md hide-sm">
                    <ion-button clear color="dark" slot="icon-only" (click)="presentPopover($event)">
                      <ion-icon name="md-more"></ion-icon>
                    </ion-button>
                  </ion-buttons>

                </ion-item>
              </ion-list>
              <ion-infinite-scroll threshold="100px" (ionInfinite)="loadData($event)">
                <ion-infinite-scroll-content loadingSpinner="bubbles" loadingText="Loading more data...">
                </ion-infinite-scroll-content>
              </ion-infinite-scroll>
            </ion-scroll>
          </ion-content>
        </ion-col>
        <ion-col size-sm="12" no-padding [ngClass]="{'full-pane':panesToggle.end && panesToggle.middle === false,'collapse-pane': !panesToggle.end, 'tasks-pane' : true}">
          <ion-toolbar>
            <ion-buttons slot="start">
              <ion-button color="dark" clear class="toolbar-round" (click)="toggleMenu('end')">
                <ion-icon [hidden]="panesToggle.end" name="arrow-dropleft"></ion-icon>
                <ion-icon [hidden]="!panesToggle.end" name="arrow-dropright"></ion-icon>
              </ion-button>
            </ion-buttons>
            <ion-buttons slot="end">
              <ion-button color="dark" clear class="toolbar-round" (click)="toggleExpand()">
                <ion-icon [hidden]="(panesToggle.end && panesToggle.middle === false && panesToggle.start === false)" name="expand"></ion-icon>
                <ion-icon [hidden]="!(panesToggle.end && panesToggle.middle === false && panesToggle.start === false)" name="contract"></ion-icon>
              </ion-button>
            </ion-buttons>

          </ion-toolbar>
          <div text-center padding [hidden]="chosenTask">
            <ion-text padding margin-top>
              <ion-icon name="egg" [ngStyle]="{'font-size': '140px','margin-top': '150px', 'opacity': 0.5}" color="primary"></ion-icon>
              <h5 padding margin [ngStyle]="{ 'opacity': 0.5}">Please choose a task to view details.</h5>
            </ion-text>
          </div>
          <ion-card mode="md" [hidden]="!chosenTask" [ngClass]="{'details-item': true}">
            <ion-card-header>
              <ion-card-subtitle>{{chosenTask?.due | date}}</ion-card-subtitle>
              <ion-card-title>{{chosenTask?.name}}</ion-card-title>
            </ion-card-header>

            <ion-card-content text-center>

            </ion-card-content>
          </ion-card>
        </ion-col>


      </ion-row>
    </ion-grid>
  </ion-split-pane>

  <!--<ion-row>
      <ion-col *ngFor="let task of filtered" col-6 col-md-4 col-lg-4>
        <ion-card [ngClass]="{'danger':task.priority > 50}">
          <ion-item>
            <ion-avatar item-start>
              <img src="http://flatable.phoenixcoded.net/default/assets/images/user.png">
            </ion-avatar>
            <h2>To: {{task.assignee}}</h2>
            <p>{{task.created | date}}</p>
          </ion-item>



          <ion-card-content>
            <p>{{task.name}}</p>
          </ion-card-content>

          <ion-row hidden>
            <ion-col>
              <button ion-button icon-start clear small>
                <div>Details</div>
              </button>
            </ion-col>
            <ion-col>
              <button ion-button icon-start clear small>
                <div>Other Acion</div>
              </button>
            </ion-col>
            <ion-col center text-center>
              <ion-note>

              </ion-note>
            </ion-col>
          </ion-row>
        </ion-card>
      </ion-col>
    </ion-row> -->
</ion-content>
